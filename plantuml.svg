<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="4797px" preserveAspectRatio="none" style="width:1533px;height:4797px;background:#FFFFFF;" version="1.1" viewBox="0 0 1533 4797" width="1533px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:1.5;" width="1476" x="40" y="228.8281"/><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:1.5;" width="1476" x="40" y="492.6953"/><rect fill="none" height="395.2031" style="stroke:#000000;stroke-width:1.5;" width="1331" x="30" y="769.5625"/><rect fill="none" height="291" style="stroke:#000000;stroke-width:1.5;" width="1311" x="40" y="822.8281"/><rect fill="none" height="574.4766" style="stroke:#000000;stroke-width:1.5;" width="1177" x="10" y="1322.2969"/><rect fill="none" height="470.2734" style="stroke:#000000;stroke-width:1.5;" width="1157" x="20" y="1375.5625"/><rect fill="none" height="323.9375" style="stroke:#000000;stroke-width:1.5;" width="1137" x="30" y="1470.9609"/><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="1537.2266"/><rect fill="none" height="499.4063" style="stroke:#000000;stroke-width:1.5;" width="1157" x="20" y="2054.3047"/><rect fill="none" height="323.9375" style="stroke:#000000;stroke-width:1.5;" width="1137" x="30" y="2178.8359"/><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="2245.1016"/><rect fill="none" height="470.2734" style="stroke:#000000;stroke-width:1.5;" width="1157" x="20" y="2711.2422"/><rect fill="none" height="366.0703" style="stroke:#000000;stroke-width:1.5;" width="1137" x="30" y="2764.5078"/><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="2872.9063"/><rect fill="none" height="148.4688" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="3600.1094"/><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="3906.1094"/><rect fill="none" height="194.4063" style="stroke:#000000;stroke-width:1.5;" width="1127" x="30" y="4153.8438"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="556.5" x="40" y="4207.1094"/><rect fill="none" height="194.4063" style="stroke:#000000;stroke-width:1.5;" width="1127" x="30" y="4505.7813"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="556.5" x="40" y="4559.0469"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="69" x2="69" y1="81.2969" y2="4717.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="568.5" x2="568.5" y1="81.2969" y2="4717.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="888.5" x2="888.5" y1="81.2969" y2="4717.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1107" x2="1107" y1="81.2969" y2="4717.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1289" x2="1289" y1="81.2969" y2="4717.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1483" x2="1483" y1="81.2969" y2="4717.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="50" y="77.9951">User</text><ellipse cx="69" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M69,21.5 L69,48.5 M56,29.5 L82,29.5 M69,48.5 L56,63.5 M69,48.5 L82,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="50" y="4729.1826">User</text><ellipse cx="69" cy="4740.9844" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M69,4748.9844 L69,4775.9844 M56,4756.9844 L82,4756.9844 M69,4775.9844 L56,4790.9844 M69,4775.9844 L82,4790.9844 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35" x="551.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="558.5" y="69.9951">API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35" x="551.5" y="4716.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="558.5" y="4736.1826">API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39" x="869.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="876.5" y="69.9951">JWT</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39" x="869.5" y="4716.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="876.5" y="4736.1826">JWT</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80" x="1067" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="1074" y="69.9951">Database</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80" x="1067" y="4716.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="1074" y="4736.1826">Database</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="1255" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1262" y="69.9951">Product</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="1255" y="4716.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1262" y="4736.1826">Product</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="1460" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="1467" y="69.9951">Auth</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="1460" y="4716.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="1467" y="4736.1826">Auth</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="111.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="111.8633" y2="111.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="114.8633" y2="114.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="64" x="731" y="101.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="45" x="737" y="117.3638">Signin</text><polygon fill="#181818" points="557,151.5625,567,155.5625,557,159.5625,561,155.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="155.5625" y2="155.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="76" y="150.4966">POST /signin</text><polygon fill="#181818" points="1471,180.6953,1481,184.6953,1471,188.6953,1475,184.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1477" y1="184.6953" y2="184.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="576" y="179.6294">signin(email, password)</text><polygon fill="#181818" points="1118,209.8281,1108,213.8281,1118,217.8281,1114,213.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1112" x2="1482" y1="213.8281" y2="213.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="352" x="1124" y="208.7622">find_one({"email": email, "password": password_hash})</text><path d="M40,228.8281 L104,228.8281 L104,235.9609 L94,245.9609 L40,245.9609 L40,228.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:1.5;" width="1476" x="40" y="228.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="241.895">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79" x="119" y="241.0386">[user found]</text><polygon fill="#181818" points="900,263.0938,890,267.0938,900,271.0938,896,267.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="1482" y1="267.0938" y2="267.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="906" y="262.0278">encode(payload, SECRET_KEY)</text><polygon fill="#181818" points="80,292.2266,70,296.2266,80,300.2266,76,296.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="1482" y1="296.2266" y2="296.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="460" x="86" y="291.1606">Response({"message": "Login successful", "token": token}, status=200)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1516" y1="305.2266" y2="305.2266"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="104" x="45" y="315.437">[user not found]</text><polygon fill="#181818" points="80,336.1641,70,340.1641,80,344.1641,76,340.1641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="1482" y1="340.1641" y2="340.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="86" y="335.0981">Response({"error": "Invalid credentials"}, status=401)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="375.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="375.7305" y2="375.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="378.7305" y2="378.7305"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="70" x="728" y="365.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51" x="734" y="381.231">Signup</text><polygon fill="#181818" points="557,415.4297,567,419.4297,557,423.4297,561,419.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="419.4297" y2="419.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="76" y="414.3638">POST /signup</text><polygon fill="#181818" points="1471,444.5625,1481,448.5625,1471,452.5625,1475,448.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1477" y1="448.5625" y2="448.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="576" y="443.4966">signup(payload)</text><polygon fill="#181818" points="1118,473.6953,1108,477.6953,1118,481.6953,1114,477.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1112" x2="1482" y1="477.6953" y2="477.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="1124" y="472.6294">find_one({"email": email})</text><path d="M40,492.6953 L104,492.6953 L104,499.8281 L94,509.8281 L40,509.8281 L40,492.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:1.5;" width="1476" x="40" y="492.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="505.7622">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="80" x="119" y="504.9058">[user exists]</text><polygon fill="#181818" points="80,526.9609,70,530.9609,80,534.9609,76,530.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="1482" y1="530.9609" y2="530.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357" x="86" y="525.895">Response({"error": "Email already exists"}, status=400)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1516" y1="539.9609" y2="539.9609"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="133" x="45" y="550.1714">[user does not exist]</text><polygon fill="#181818" points="1118,570.8984,1108,574.8984,1118,578.8984,1114,574.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1112" x2="1482" y1="574.8984" y2="574.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="1124" y="569.8325">insert_one(new_user)</text><polygon fill="#181818" points="80,600.0313,70,604.0313,80,608.0313,76,604.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="1482" y1="604.0313" y2="604.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437" x="86" y="598.9653">Response({"message": "User registered successfully"}, status=201)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="639.5977"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="639.5977" y2="639.5977"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="642.5977" y2="642.5977"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="126" x="700" y="629.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107" x="706" y="645.0981">CreateProduct</text><polygon fill="#181818" points="557,679.2969,567,683.2969,557,687.2969,561,683.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="683.2969" y2="683.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="76" y="678.231">POST /create_product</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="712.4297" y2="712.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="712.4297" y2="725.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="725.4297" y2="725.4297"/><polygon fill="#181818" points="580,721.4297,570,725.4297,580,729.4297,576,725.4297" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="576" y="707.3638">get_token(request)</text><polygon fill="#181818" points="877,750.5625,887,754.5625,877,758.5625,881,754.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="883" y1="754.5625" y2="754.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="576" y="749.4966">decode(token, SECRET_KEY)</text><path d="M30,769.5625 L94,769.5625 L94,776.6953 L84,786.6953 L30,786.6953 L30,769.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="395.2031" style="stroke:#000000;stroke-width:1.5;" width="1331" x="30" y="769.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="782.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81" x="109" y="781.7729">[valid token]</text><polygon fill="#181818" points="1095,803.8281,1105,807.8281,1095,811.8281,1099,807.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="807.8281" y2="807.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="576" y="802.7622">find_one({"email": email})</text><path d="M40,822.8281 L104,822.8281 L104,829.9609 L94,839.9609 L40,839.9609 L40,822.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="291" style="stroke:#000000;stroke-width:1.5;" width="1311" x="40" y="822.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="835.895">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="137" x="119" y="835.0386">[user is manufactory]</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="861.0938" y2="861.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="861.0938" y2="874.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="874.0938" y2="874.0938"/><polygon fill="#181818" points="580,870.0938,570,874.0938,580,878.0938,576,874.0938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="576" y="856.0278">get product details from request</text><polygon fill="#181818" points="1277,899.2266,1287,903.2266,1277,907.2266,1281,903.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1283" y1="903.2266" y2="903.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="576" y="898.1606">create product</text><line style="stroke:#181818;stroke-width:1.0;" x1="1289" x2="1331" y1="932.3594" y2="932.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="1331" x2="1331" y1="932.3594" y2="945.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="1290" x2="1331" y1="945.3594" y2="945.3594"/><polygon fill="#181818" points="1300,941.3594,1290,945.3594,1300,949.3594,1296,945.3594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="1296" y="927.2935">store()</text><polygon fill="#181818" points="1118,970.4922,1108,974.4922,1118,978.4922,1114,974.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1112" x2="1288" y1="974.4922" y2="974.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="1124" y="969.4263">insert_one(new_product)</text><polygon fill="#181818" points="1095,999.625,1105,1003.625,1095,1007.625,1099,1003.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="1003.625" y2="1003.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="447" x="576" y="998.5591">update_one({"email": email}, {"$set": {"Inventory": user_inventory}})</text><polygon fill="#181818" points="1095,1028.7578,1105,1032.7578,1095,1036.7578,1099,1032.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="1032.7578" y2="1032.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="475" x="576" y="1027.6919">update_one({"email": email}, {"$set": {"Transaction": user_transaction}})</text><polygon fill="#181818" points="80,1057.8906,70,1061.8906,80,1065.8906,76,1061.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="1061.8906" y2="1061.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="440" x="86" y="1056.8247">Response({"message": "Product created successfully"}, status=201)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1351" y1="1070.8906" y2="1070.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="85" x="45" y="1081.1011">[invalid user]</text><polygon fill="#181818" points="80,1101.8281,70,1105.8281,80,1109.8281,76,1105.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="1105.8281" y2="1105.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302" x="86" y="1100.7622">Response({"error": "Invalid user"}, status=401)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="1361" y1="1121.8281" y2="1121.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="35" y="1132.0386">[invalid token]</text><polygon fill="#181818" points="80,1152.7656,70,1156.7656,80,1160.7656,76,1156.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="1156.7656" y2="1156.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="86" y="1151.6997">Response({"error": "Invalid token"}, status=401)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="1192.332"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="1192.332" y2="1192.332"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="1195.332" y2="1195.332"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="140" x="693" y="1181.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121" x="699" y="1197.8325">Purchase_retails</text><polygon fill="#181818" points="557,1232.0313,567,1236.0313,557,1240.0313,561,1236.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="1236.0313" y2="1236.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="76" y="1230.9653">POST /purchase_retails</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="1265.1641" y2="1265.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="1265.1641" y2="1278.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="1278.1641" y2="1278.1641"/><polygon fill="#181818" points="580,1274.1641,570,1278.1641,580,1282.1641,576,1278.1641" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="576" y="1260.0981">get_token(request)</text><polygon fill="#181818" points="877,1303.2969,887,1307.2969,877,1311.2969,881,1307.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="883" y1="1307.2969" y2="1307.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="576" y="1302.231">decode(token, SECRET_KEY)</text><path d="M10,1322.2969 L74,1322.2969 L74,1329.4297 L64,1339.4297 L10,1339.4297 L10,1322.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="574.4766" style="stroke:#000000;stroke-width:1.5;" width="1177" x="10" y="1322.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="1335.3638">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81" x="89" y="1334.5073">[valid token]</text><polygon fill="#181818" points="1095,1356.5625,1105,1360.5625,1095,1364.5625,1099,1360.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="1360.5625" y2="1360.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="576" y="1355.4966">find_one({"email": email})</text><path d="M20,1375.5625 L84,1375.5625 L84,1382.6953 L74,1392.6953 L20,1392.6953 L20,1375.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="470.2734" style="stroke:#000000;stroke-width:1.5;" width="1157" x="20" y="1375.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="1388.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="91" x="99" y="1387.7729">[user is retail]</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="1413.8281" y2="1413.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="1413.8281" y2="1426.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="1426.8281" y2="1426.8281"/><polygon fill="#181818" points="580,1422.8281,570,1426.8281,580,1430.8281,576,1426.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263" x="576" y="1408.7622">get product_id and quantity from request</text><polygon fill="#181818" points="1095,1451.9609,1105,1455.9609,1095,1459.9609,1099,1455.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="1455.9609" y2="1455.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="576" y="1450.895">find_one({"_id": ObjectId(product_id)})</text><path d="M30,1470.9609 L94,1470.9609 L94,1478.0938 L84,1488.0938 L30,1488.0938 L30,1470.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="323.9375" style="stroke:#000000;stroke-width:1.5;" width="1137" x="30" y="1470.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="1484.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="100" x="109" y="1483.1714">[product found]</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="1509.2266" y2="1509.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="1509.2266" y2="1522.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="1522.2266" y2="1522.2266"/><polygon fill="#181818" points="580,1518.2266,570,1522.2266,580,1526.2266,576,1522.2266" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="576" y="1504.1606">check balance and quantity</text><path d="M40,1537.2266 L104,1537.2266 L104,1544.3594 L94,1554.3594 L40,1554.3594 L40,1537.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="1537.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="1550.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="211" x="119" y="1549.437">[sufficient balance and quantity]</text><polygon fill="#181818" points="1095,1571.4922,1105,1575.4922,1095,1579.4922,1099,1575.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="1575.4922" y2="1575.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="478" x="576" y="1570.4263">update_one({"_id": ObjectId(product_id)}, {"$inc": {"quantity": -quantity}})</text><polygon fill="#181818" points="1095,1600.625,1105,1604.625,1095,1608.625,1099,1604.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="1604.625" y2="1604.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="364" x="576" y="1599.5591">update manufactory and user inventory and transactions</text><polygon fill="#181818" points="1095,1629.7578,1105,1633.7578,1095,1637.7578,1099,1633.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="1633.7578" y2="1633.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="514" x="576" y="1628.6919">update_one({"email": manufactory_email}, {"$set": {"balance": new_balance}})</text><polygon fill="#181818" points="1095,1658.8906,1105,1662.8906,1095,1666.8906,1099,1662.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="1662.8906" y2="1662.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426" x="576" y="1657.8247">update_one({"email": email}, {"$set": {"balance": new_balance}})</text><polygon fill="#181818" points="80,1688.0234,70,1692.0234,80,1696.0234,76,1692.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="1692.0234" y2="1692.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387" x="86" y="1686.9575">Response({"message": "Purchase successful"}, status=200)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1157" y1="1701.0234" y2="1701.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="212" x="45" y="1711.2339">[insufficient balance or quantity]</text><polygon fill="#181818" points="80,1731.9609,70,1735.9609,80,1739.9609,76,1735.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="1735.9609" y2="1735.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="432" x="86" y="1730.895">Response({"error": "Not enough balance or quantity"}, status=400)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="1167" y1="1751.9609" y2="1751.9609"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125" x="35" y="1762.1714">[product not found]</text><polygon fill="#181818" points="80,1782.8984,70,1786.8984,80,1790.8984,76,1786.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="1786.8984" y2="1786.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="86" y="1781.8325">Response({"error": "Product not found"}, status=404)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1177" y1="1802.8984" y2="1802.8984"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="117" x="25" y="1813.1089">[invalid user type]</text><polygon fill="#181818" points="80,1833.8359,70,1837.8359,80,1841.8359,76,1837.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="1837.8359" y2="1837.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334" x="86" y="1832.77">Response({"error": "Invalid user type"}, status=401)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1187" y1="1853.8359" y2="1853.8359"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="15" y="1864.0464">[invalid token]</text><polygon fill="#181818" points="80,1884.7734,70,1888.7734,80,1892.7734,76,1888.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="1888.7734" y2="1888.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="86" y="1883.7075">Response({"error": "Invalid token"}, status=401)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="1924.3398"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="1924.3398" y2="1924.3398"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="1927.3398" y2="1927.3398"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="163" x="681.5" y="1913.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="687.5" y="1929.8403">Purchase_customer</text><polygon fill="#181818" points="557,1964.0391,567,1968.0391,557,1972.0391,561,1968.0391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="1968.0391" y2="1968.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="76" y="1962.9731">POST /purchase_customer</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="1997.1719" y2="1997.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="1997.1719" y2="2010.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="2010.1719" y2="2010.1719"/><polygon fill="#181818" points="580,2006.1719,570,2010.1719,580,2014.1719,576,2010.1719" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="576" y="1992.106">get_token(request)</text><polygon fill="#181818" points="877,2035.3047,887,2039.3047,877,2043.3047,881,2039.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="883" y1="2039.3047" y2="2039.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="576" y="2034.2388">decode(token, SECRET_KEY)</text><path d="M20,2054.3047 L84,2054.3047 L84,2061.4375 L74,2071.4375 L20,2071.4375 L20,2054.3047 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="499.4063" style="stroke:#000000;stroke-width:1.5;" width="1157" x="20" y="2054.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="2067.3716">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81" x="99" y="2066.5151">[valid token]</text><polygon fill="#181818" points="1095,2088.5703,1105,2092.5703,1095,2096.5703,1099,2092.5703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2092.5703" y2="2092.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="576" y="2087.5044">find_one({"email": email})</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="2121.7031" y2="2121.7031"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="2121.7031" y2="2134.7031"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="2134.7031" y2="2134.7031"/><polygon fill="#181818" points="580,2130.7031,570,2134.7031,580,2138.7031,576,2134.7031" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263" x="576" y="2116.6372">get product_id and quantity from request</text><polygon fill="#181818" points="1095,2159.8359,1105,2163.8359,1095,2167.8359,1099,2163.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2163.8359" y2="2163.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="576" y="2158.77">find_one({"_id": ObjectId(product_id)})</text><path d="M30,2178.8359 L94,2178.8359 L94,2185.9688 L84,2195.9688 L30,2195.9688 L30,2178.8359 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="323.9375" style="stroke:#000000;stroke-width:1.5;" width="1137" x="30" y="2178.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="2191.9028">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="100" x="109" y="2191.0464">[product found]</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="2217.1016" y2="2217.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="2217.1016" y2="2230.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="2230.1016" y2="2230.1016"/><polygon fill="#181818" points="580,2226.1016,570,2230.1016,580,2234.1016,576,2230.1016" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="576" y="2212.0356">check balance and quantity</text><path d="M40,2245.1016 L104,2245.1016 L104,2252.2344 L94,2262.2344 L40,2262.2344 L40,2245.1016 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="2245.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="2258.1685">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="211" x="119" y="2257.312">[sufficient balance and quantity]</text><polygon fill="#181818" points="1095,2279.3672,1105,2283.3672,1095,2287.3672,1099,2283.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2283.3672" y2="2283.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="478" x="576" y="2278.3013">update_one({"_id": ObjectId(product_id)}, {"$inc": {"quantity": -quantity}})</text><polygon fill="#181818" points="1095,2308.5,1105,2312.5,1095,2316.5,1099,2312.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2312.5" y2="2312.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315" x="576" y="2307.4341">update retail and user inventory and transactions</text><polygon fill="#181818" points="1095,2337.6328,1105,2341.6328,1095,2345.6328,1099,2341.6328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2341.6328" y2="2341.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="468" x="576" y="2336.5669">update_one({"email": Retail_email}, {"$set": {"balance": new_balance}})</text><polygon fill="#181818" points="1095,2366.7656,1105,2370.7656,1095,2374.7656,1099,2370.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2370.7656" y2="2370.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426" x="576" y="2365.6997">update_one({"email": email}, {"$set": {"balance": new_balance}})</text><polygon fill="#181818" points="80,2395.8984,70,2399.8984,80,2403.8984,76,2399.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="2399.8984" y2="2399.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387" x="86" y="2394.8325">Response({"message": "Purchase successful"}, status=200)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1157" y1="2408.8984" y2="2408.8984"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="212" x="45" y="2419.1089">[insufficient balance or quantity]</text><polygon fill="#181818" points="80,2439.8359,70,2443.8359,80,2447.8359,76,2443.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="2443.8359" y2="2443.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="432" x="86" y="2438.77">Response({"error": "Not enough balance or quantity"}, status=400)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="1167" y1="2459.8359" y2="2459.8359"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125" x="35" y="2470.0464">[product not found]</text><polygon fill="#181818" points="80,2490.7734,70,2494.7734,80,2498.7734,76,2494.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="2494.7734" y2="2494.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="86" y="2489.7075">Response({"error": "Product not found"}, status=404)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1177" y1="2510.7734" y2="2510.7734"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="25" y="2520.9839">[invalid token]</text><polygon fill="#181818" points="80,2541.7109,70,2545.7109,80,2549.7109,76,2545.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="2545.7109" y2="2545.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="86" y="2540.645">Response({"error": "Invalid token"}, status=401)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="2581.2773"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="2581.2773" y2="2581.2773"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="2584.2773" y2="2584.2773"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="45" x="740.5" y="2570.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26" x="746.5" y="2586.7778">Sell</text><polygon fill="#181818" points="557,2620.9766,567,2624.9766,557,2628.9766,561,2624.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="2624.9766" y2="2624.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="76" y="2619.9106">POST /sell</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="2654.1094" y2="2654.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="2654.1094" y2="2667.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="2667.1094" y2="2667.1094"/><polygon fill="#181818" points="580,2663.1094,570,2667.1094,580,2671.1094,576,2667.1094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="576" y="2649.0435">get_token(request)</text><polygon fill="#181818" points="877,2692.2422,887,2696.2422,877,2700.2422,881,2696.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="883" y1="2696.2422" y2="2696.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="576" y="2691.1763">decode(token, SECRET_KEY)</text><path d="M20,2711.2422 L84,2711.2422 L84,2718.375 L74,2728.375 L20,2728.375 L20,2711.2422 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="470.2734" style="stroke:#000000;stroke-width:1.5;" width="1157" x="20" y="2711.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="2724.3091">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81" x="99" y="2723.4526">[valid token]</text><polygon fill="#181818" points="1095,2745.5078,1105,2749.5078,1095,2753.5078,1099,2749.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2749.5078" y2="2749.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="576" y="2744.4419">find_one({"email": email})</text><path d="M30,2764.5078 L94,2764.5078 L94,2771.6406 L84,2781.6406 L30,2781.6406 L30,2764.5078 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="366.0703" style="stroke:#000000;stroke-width:1.5;" width="1137" x="30" y="2764.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="2777.5747">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="91" x="109" y="2776.7183">[user is retail]</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="2802.7734" y2="2802.7734"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="2802.7734" y2="2815.7734"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="2815.7734" y2="2815.7734"/><polygon fill="#181818" points="580,2811.7734,570,2815.7734,580,2819.7734,576,2815.7734" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="576" y="2797.7075">get product_id, price, and quantity from request</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="2844.9063" y2="2844.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="2844.9063" y2="2857.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="2857.9063" y2="2857.9063"/><polygon fill="#181818" points="580,2853.9063,570,2857.9063,580,2861.9063,576,2857.9063" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="576" y="2839.8403">check inventory</text><path d="M40,2872.9063 L104,2872.9063 L104,2880.0391 L94,2890.0391 L40,2890.0391 L40,2872.9063 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="2872.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="2885.9731">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="180" x="119" y="2885.1167">[product found in inventory]</text><polygon fill="#181818" points="1095,2907.1719,1105,2911.1719,1095,2915.1719,1099,2911.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2911.1719" y2="2911.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="576" y="2906.106">update inventory</text><polygon fill="#181818" points="1095,2936.3047,1105,2940.3047,1095,2944.3047,1099,2940.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2940.3047" y2="2940.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="576" y="2935.2388">insert_one(new_sale_product)</text><polygon fill="#181818" points="1095,2965.4375,1105,2969.4375,1095,2973.4375,1099,2969.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2969.4375" y2="2969.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="444" x="576" y="2964.3716">update_one({"email": email}, {"$set": {"Inventory": new_inventory}})</text><polygon fill="#181818" points="1095,2994.5703,1105,2998.5703,1095,3002.5703,1099,2998.5703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="2998.5703" y2="2998.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="451" x="576" y="2993.5044">update_one({"email": email}, {"$push": {"Transaction": transaction}})</text><polygon fill="#181818" points="80,3023.7031,70,3027.7031,80,3031.7031,76,3027.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3027.7031" y2="3027.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476" x="86" y="3022.6372">Response({"message": "Product listed for sale successfully"}, status=201)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1157" y1="3036.7031" y2="3036.7031"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="205" x="45" y="3046.9136">[product not found in inventory]</text><polygon fill="#181818" points="80,3067.6406,70,3071.6406,80,3075.6406,76,3071.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3071.6406" y2="3071.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="422" x="86" y="3066.5747">Response({"error": "Product not found in inventory"}, status=404)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="1167" y1="3087.6406" y2="3087.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="117" x="35" y="3097.8511">[invalid user type]</text><polygon fill="#181818" points="80,3118.5781,70,3122.5781,80,3126.5781,76,3122.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3122.5781" y2="3122.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="445" x="86" y="3117.5122">Response({"error": "Only retail users can sell products"}, status=401)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1177" y1="3138.5781" y2="3138.5781"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="25" y="3148.7886">[invalid token]</text><polygon fill="#181818" points="80,3169.5156,70,3173.5156,80,3177.5156,76,3173.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3173.5156" y2="3173.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="86" y="3168.4497">Response({"error": "Invalid token"}, status=401)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="3209.082"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="3209.082" y2="3209.082"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="3212.082" y2="3212.082"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="187" x="669.5" y="3198.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="675.5" y="3214.5825">Show_list_manufactory</text><polygon fill="#181818" points="557,3248.7813,567,3252.7813,557,3256.7813,561,3252.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="3252.7813" y2="3252.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="76" y="3247.7153">GET /show_list_manufactory</text><polygon fill="#181818" points="1095,3277.9141,1105,3281.9141,1095,3285.9141,1099,3281.9141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="3281.9141" y2="3281.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="576" y="3276.8481">find({"type": "manufactory"})</text><polygon fill="#181818" points="80,3307.0469,70,3311.0469,80,3315.0469,76,3311.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3311.0469" y2="3311.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="86" y="3305.981">Response(manufactory_list, status=200)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="3339.6133"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="3339.6133" y2="3339.6133"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="3342.6133" y2="3342.6133"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="130" x="698" y="3329.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="704" y="3345.1138">Show_item_sell</text><polygon fill="#181818" points="557,3379.3125,567,3383.3125,557,3387.3125,561,3383.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="3383.3125" y2="3383.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="76" y="3378.2466">GET /show_item_sell</text><polygon fill="#181818" points="1095,3408.4453,1105,3412.4453,1095,3416.4453,1099,3412.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="3412.4453" y2="3412.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="576" y="3407.3794">find({})</text><polygon fill="#181818" points="80,3437.5781,70,3441.5781,80,3445.5781,76,3441.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3441.5781" y2="3441.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="86" y="3436.5122">Response(product_list, status=200)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="3470.1445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="3470.1445" y2="3470.1445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="3473.1445" y2="3473.1445"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="173" x="676.5" y="3459.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="682.5" y="3475.645">Show_item_inventory</text><polygon fill="#181818" points="557,3509.8438,567,3513.8438,557,3517.8438,561,3513.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="3513.8438" y2="3513.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="76" y="3508.7778">GET /show_item_inventory</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="3542.9766" y2="3542.9766"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="3542.9766" y2="3555.9766"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="3555.9766" y2="3555.9766"/><polygon fill="#181818" points="580,3551.9766,570,3555.9766,580,3559.9766,576,3555.9766" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="576" y="3537.9106">get_token(request)</text><polygon fill="#181818" points="877,3581.1094,887,3585.1094,877,3589.1094,881,3585.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="883" y1="3585.1094" y2="3585.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="576" y="3580.0435">decode(token, SECRET_KEY)</text><path d="M40,3600.1094 L104,3600.1094 L104,3607.2422 L94,3617.2422 L40,3617.2422 L40,3600.1094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="148.4688" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="3600.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="3613.1763">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81" x="119" y="3612.3198">[valid token]</text><polygon fill="#181818" points="1095,3634.375,1105,3638.375,1095,3642.375,1099,3638.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="3638.375" y2="3638.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="576" y="3633.3091">find_one({"email": email})</text><polygon fill="#181818" points="1095,3663.5078,1105,3667.5078,1095,3671.5078,1099,3667.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="3667.5078" y2="3667.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="277" x="576" y="3662.4419">find_one({"_id": ObjectId(manufactory_id)})</text><polygon fill="#181818" points="80,3692.6406,70,3696.6406,80,3700.6406,76,3696.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3696.6406" y2="3696.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="86" y="3691.5747">Response(inventory_list, status=200)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1157" y1="3705.6406" y2="3705.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="45" y="3715.8511">[invalid token]</text><polygon fill="#181818" points="80,3736.5781,70,3740.5781,80,3744.5781,76,3740.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3740.5781" y2="3740.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="86" y="3735.5122">Response({"error": "Invalid token"}, status=401)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="3776.1445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="3776.1445" y2="3776.1445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="3779.1445" y2="3779.1445"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="188" x="669" y="3765.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169" x="675" y="3781.645">Show_item_transaction</text><polygon fill="#181818" points="557,3815.8438,567,3819.8438,557,3823.8438,561,3819.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="3819.8438" y2="3819.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="76" y="3814.7778">GET /show_item_transaction</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="3848.9766" y2="3848.9766"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="3848.9766" y2="3861.9766"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="3861.9766" y2="3861.9766"/><polygon fill="#181818" points="580,3857.9766,570,3861.9766,580,3865.9766,576,3861.9766" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="576" y="3843.9106">get_token(request)</text><polygon fill="#181818" points="877,3887.1094,887,3891.1094,877,3895.1094,881,3891.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="883" y1="3891.1094" y2="3891.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="576" y="3886.0435">decode(token, SECRET_KEY)</text><path d="M40,3906.1094 L104,3906.1094 L104,3913.2422 L94,3923.2422 L40,3923.2422 L40,3906.1094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:1.5;" width="1117" x="40" y="3906.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="3919.1763">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81" x="119" y="3918.3198">[valid token]</text><polygon fill="#181818" points="1095,3940.375,1105,3944.375,1095,3948.375,1099,3944.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="3944.375" y2="3944.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="576" y="3939.3091">find_one({"email": email})</text><polygon fill="#181818" points="80,3969.5078,70,3973.5078,80,3977.5078,76,3973.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="3973.5078" y2="3973.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="86" y="3968.4419">Response(transaction_list, status=200)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1157" y1="3982.5078" y2="3982.5078"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="45" y="3992.7183">[invalid token]</text><polygon fill="#181818" points="80,4013.4453,70,4017.4453,80,4021.4453,76,4017.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="4017.4453" y2="4017.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="86" y="4012.3794">Response({"error": "Invalid token"}, status=401)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="4053.0117"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="4053.0117" y2="4053.0117"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="4056.0117" y2="4056.0117"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="105" x="710.5" y="4042.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="86" x="716.5" y="4058.5122">show_name</text><polygon fill="#181818" points="557,4092.7109,567,4096.7109,557,4100.7109,561,4096.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="4096.7109" y2="4096.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="76" y="4091.645">POST /show_name</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="4125.8438" y2="4125.8438"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="4125.8438" y2="4138.8438"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="4138.8438" y2="4138.8438"/><polygon fill="#181818" points="580,4134.8438,570,4138.8438,580,4142.8438,576,4138.8438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="576" y="4120.7778">get id from request</text><path d="M30,4153.8438 L94,4153.8438 L94,4160.9766 L84,4170.9766 L30,4170.9766 L30,4153.8438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="194.4063" style="stroke:#000000;stroke-width:1.5;" width="1127" x="30" y="4153.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="4166.9106">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82" x="109" y="4166.0542">[id provided]</text><polygon fill="#181818" points="1095,4188.1094,1105,4192.1094,1095,4196.1094,1099,4192.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="4192.1094" y2="4192.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="328" x="576" y="4187.0435">find_one({"_id": ObjectId(id)}, {"name": 1, "_id": 0})</text><path d="M40,4207.1094 L104,4207.1094 L104,4214.2422 L94,4224.2422 L40,4224.2422 L40,4207.1094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="556.5" x="40" y="4207.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="4220.1763">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79" x="119" y="4219.3198">[user found]</text><polygon fill="#181818" points="80,4241.375,70,4245.375,80,4249.375,76,4245.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="4245.375" y2="4245.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="86" y="4240.3091">Response(user, status=200)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="596.5" y1="4254.375" y2="4254.375"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="104" x="45" y="4264.5854">[user not found]</text><polygon fill="#181818" points="80,4285.3125,70,4289.3125,80,4293.3125,76,4289.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="4289.3125" y2="4289.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325" x="86" y="4284.2466">Response({"error": "User not found"}, status=404)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="1157" y1="4305.3125" y2="4305.3125"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="107" x="35" y="4315.5229">[id not provided]</text><polygon fill="#181818" points="80,4336.25,70,4340.25,80,4344.25,76,4340.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="4340.25" y2="4340.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314" x="86" y="4335.1841">Response({"error": "ID is required"}, status=400)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="4375.8164"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="4375.8164" y2="4375.8164"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="4378.8164" y2="4378.8164"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="100" x="713" y="4365.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81" x="719" y="4381.3169">UserProfile</text><polygon fill="#181818" points="557,4415.5156,567,4419.5156,557,4423.5156,561,4419.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="69" x2="563" y1="4419.5156" y2="4419.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="76" y="4414.4497">GET /user_profile</text><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="611" y1="4448.6484" y2="4448.6484"/><line style="stroke:#181818;stroke-width:1.0;" x1="611" x2="611" y1="4448.6484" y2="4461.6484"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="611" y1="4461.6484" y2="4461.6484"/><polygon fill="#181818" points="580,4457.6484,570,4461.6484,580,4465.6484,576,4461.6484" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="576" y="4443.5825">get_token(request)</text><polygon fill="#181818" points="877,4486.7813,887,4490.7813,877,4494.7813,881,4490.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="883" y1="4490.7813" y2="4490.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="576" y="4485.7153">decode(token, SECRET_KEY)</text><path d="M30,4505.7813 L94,4505.7813 L94,4512.9141 L84,4522.9141 L30,4522.9141 L30,4505.7813 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="194.4063" style="stroke:#000000;stroke-width:1.5;" width="1127" x="30" y="4505.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="4518.8481">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81" x="109" y="4517.9917">[valid token]</text><polygon fill="#181818" points="1095,4540.0469,1105,4544.0469,1095,4548.0469,1099,4544.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="569" x2="1101" y1="4544.0469" y2="4544.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330" x="576" y="4538.981">find_one({"email": email}, {"_id": 0, "password": 0})</text><path d="M40,4559.0469 L104,4559.0469 L104,4566.1797 L94,4576.1797 L40,4576.1797 L40,4559.0469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="556.5" x="40" y="4559.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55" y="4572.1138">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79" x="119" y="4571.2573">[user found]</text><polygon fill="#181818" points="80,4593.3125,70,4597.3125,80,4601.3125,76,4597.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="4597.3125" y2="4597.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="86" y="4592.2466">Response(user_profile, status=200)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="596.5" y1="4606.3125" y2="4606.3125"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="104" x="45" y="4616.5229">[user not found]</text><polygon fill="#181818" points="80,4637.25,70,4641.25,80,4645.25,76,4641.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="4641.25" y2="4641.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325" x="86" y="4636.1841">Response({"error": "User not found"}, status=404)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="1157" y1="4657.25" y2="4657.25"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="35" y="4667.4604">[invalid token]</text><polygon fill="#181818" points="80,4688.1875,70,4692.1875,80,4696.1875,76,4692.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="568" y1="4692.1875" y2="4692.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="86" y="4687.1216">Response({"error": "Invalid token"}, status=401)</text><!--MD5=[c9ee744ac9613031784defe5a2630102]
@startuml
actor User
participant "API" as API
participant "JWT" as JWT
participant "Database" as DB
participant "Product" as Product

== Signin ==
User -> API: POST /signin
API -> Auth: signin(email, password)
Auth -> DB: find_one({"email": email, "password": password_hash})
alt user found
    Auth -> JWT: encode(payload, SECRET_KEY)
    Auth -> User: Response({"message": "Login successful", "token": token}, status=200)
else user not found
    Auth -> User: Response({"error": "Invalid credentials"}, status=401)
end

== Signup ==
User -> API: POST /signup
API -> Auth: signup(payload)
Auth -> DB: find_one({"email": email})
alt user exists
    Auth -> User: Response({"error": "Email already exists"}, status=400)
else user does not exist
    Auth -> DB: insert_one(new_user)
    Auth -> User: Response({"message": "User registered successfully"}, status=201)
end

== CreateProduct ==
User -> API: POST /create_product
API -> API: get_token(request)
API -> JWT: decode(token, SECRET_KEY)
alt valid token
    API -> DB: find_one({"email": email})
    alt user is manufactory
        API -> API: get product details from request
        API -> Product: create product
        Product -> Product: store()
        Product -> DB: insert_one(new_product)
        API -> DB: update_one({"email": email}, {"$set": {"Inventory": user_inventory}})
        API -> DB: update_one({"email": email}, {"$set": {"Transaction": user_transaction}})
        API -> User: Response({"message": "Product created successfully"}, status=201)
    else invalid user
        API -> User: Response({"error": "Invalid user"}, status=401)
    end
else invalid token
    API -> User: Response({"error": "Invalid token"}, status=401)
end

== Purchase_retails ==
User -> API: POST /purchase_retails
API -> API: get_token(request)
API -> JWT: decode(token, SECRET_KEY)
alt valid token
    API -> DB: find_one({"email": email})
    alt user is retail
        API -> API: get product_id and quantity from request
        API -> DB: find_one({"_id": ObjectId(product_id)})
        alt product found
            API -> API: check balance and quantity
            alt sufficient balance and quantity
                API -> DB: update_one({"_id": ObjectId(product_id)}, {"$inc": {"quantity": -quantity}})
                API -> DB: update manufactory and user inventory and transactions
                API -> DB: update_one({"email": manufactory_email}, {"$set": {"balance": new_balance}})
                API -> DB: update_one({"email": email}, {"$set": {"balance": new_balance}})
                API -> User: Response({"message": "Purchase successful"}, status=200)
            else insufficient balance or quantity
                API -> User: Response({"error": "Not enough balance or quantity"}, status=400)
            end
        else product not found
            API -> User: Response({"error": "Product not found"}, status=404)
        end
    else invalid user type
        API -> User: Response({"error": "Invalid user type"}, status=401)
    end
else invalid token
    API -> User: Response({"error": "Invalid token"}, status=401)
end

== Purchase_customer ==
User -> API: POST /purchase_customer
API -> API: get_token(request)
API -> JWT: decode(token, SECRET_KEY)
alt valid token
    API -> DB: find_one({"email": email})
    API -> API: get product_id and quantity from request
    API -> DB: find_one({"_id": ObjectId(product_id)})
    alt product found
        API -> API: check balance and quantity
        alt sufficient balance and quantity
            API -> DB: update_one({"_id": ObjectId(product_id)}, {"$inc": {"quantity": -quantity}})
            API -> DB: update retail and user inventory and transactions
            API -> DB: update_one({"email": Retail_email}, {"$set": {"balance": new_balance}})
            API -> DB: update_one({"email": email}, {"$set": {"balance": new_balance}})
            API -> User: Response({"message": "Purchase successful"}, status=200)
        else insufficient balance or quantity
            API -> User: Response({"error": "Not enough balance or quantity"}, status=400)
        end
    else product not found
        API -> User: Response({"error": "Product not found"}, status=404)
    end
else invalid token
    API -> User: Response({"error": "Invalid token"}, status=401)
end

== Sell ==
User -> API: POST /sell
API -> API: get_token(request)
API -> JWT: decode(token, SECRET_KEY)
alt valid token
    API -> DB: find_one({"email": email})
    alt user is retail
        API -> API: get product_id, price, and quantity from request
        API -> API: check inventory
        alt product found in inventory
            API -> DB: update inventory
            API -> DB: insert_one(new_sale_product)
            API -> DB: update_one({"email": email}, {"$set": {"Inventory": new_inventory}})
            API -> DB: update_one({"email": email}, {"$push": {"Transaction": transaction}})
            API -> User: Response({"message": "Product listed for sale successfully"}, status=201)
        else product not found in inventory
            API -> User: Response({"error": "Product not found in inventory"}, status=404)
        end
    else invalid user type
        API -> User: Response({"error": "Only retail users can sell products"}, status=401)
    end
else invalid token
    API -> User: Response({"error": "Invalid token"}, status=401)
end

== Show_list_manufactory ==
User -> API: GET /show_list_manufactory
API -> DB: find({"type": "manufactory"})
API -> User: Response(manufactory_list, status=200)

== Show_item_sell ==
User -> API: GET /show_item_sell
API -> DB: find({})
API -> User: Response(product_list, status=200)

== Show_item_inventory ==
User -> API: GET /show_item_inventory
API -> API: get_token(request)
API -> JWT: decode(token, SECRET_KEY)
alt valid token
    API -> DB: find_one({"email": email})
    API -> DB: find_one({"_id": ObjectId(manufactory_id)})
    API -> User: Response(inventory_list, status=200)
else invalid token
    API -> User: Response({"error": "Invalid token"}, status=401)
end

== Show_item_transaction ==
User -> API: GET /show_item_transaction
API -> API: get_token(request)
API -> JWT: decode(token, SECRET_KEY)
alt valid token
    API -> DB: find_one({"email": email})
    API -> User: Response(transaction_list, status=200)
else invalid token
    API -> User: Response({"error": "Invalid token"}, status=401)
end

== show_name ==
User -> API: POST /show_name
API -> API: get id from request
alt id provided
    API -> DB: find_one({"_id": ObjectId(id)}, {"name": 1, "_id": 0})
    alt user found
        API -> User: Response(user, status=200)
    else user not found
        API -> User: Response({"error": "User not found"}, status=404)
    end
else id not provided
    API -> User: Response({"error": "ID is required"}, status=400)
end

== UserProfile ==
User -> API: GET /user_profile
API -> API: get_token(request)
API -> JWT: decode(token, SECRET_KEY)
alt valid token
    API -> DB: find_one({"email": email}, {"_id": 0, "password": 0})
    alt user found
        API -> User: Response(user_profile, status=200)
    else user not found
        API -> User: Response({"error": "User not found"}, status=404)
    end
else invalid token
    API -> User: Response({"error": "Invalid token"}, status=401)
end
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>